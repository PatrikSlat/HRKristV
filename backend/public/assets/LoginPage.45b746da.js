import{a as p,Q as w}from"./QCard.4a2f20aa.js";import{Q as h,a as m}from"./QForm.bf298595.js";import{Q as k}from"./QBtn.03a6d40c.js";import{Q as _}from"./QPage.f683395d.js";import{r as o,F as y,x as b,I as x,J as Q,K as l,L as r,R as s,a3 as L}from"./index.fab7c2d1.js";import{a as V}from"./axios.703e2798.js";import"./render.b3f1a79a.js";import"./use-dark.5ea04310.js";const j={class:"q-mt-md flex flex-center"},z={class:"q-mt-lg"},A="6LcHG14rAAAAAC0OGkLyXUJvaEQLpEQZu2aK2u-v",C={__name:"LoginPage",setup(I){const i=o(""),n=o(""),a=o(""),d=o(null),u=o(null),f=y(),v="/api/auth/login/organizator";b(()=>{a.value="",window.grecaptcha&&u.value&&window.grecaptcha.render(u.value,{sitekey:A,callback:function(c){a.value=c}})});async function g(){if(!await d.value.validate()||!a.value){alert("Morate potvrditi da niste robot!");return}try{const e=await V.post(v,{username:i.value,password:n.value,recaptchaToken:a.value});localStorage.setItem("jwt_token",e.data.token),localStorage.setItem("user",JSON.stringify(e.data.user)),f.push({name:"adminDashboard"}),window.grecaptcha&&window.grecaptcha.reset(),a.value=""}catch(e){e.response?alert(e.response.data.message||"Gre\u0161ka prilikom prijave!"):alert("Neuspjela prijava!"),window.grecaptcha&&window.grecaptcha.reset(),a.value="",console.error("Gre\u0161ka prilikom prijave:",e)}}return(c,e)=>(x(),Q(_,{padding:"",class:"flex flex-center bg-grey-2 login-page"},{default:l(()=>[r(w,{class:"login-card shadow-5",style:{width:"100%","max-width":"400px"}},{default:l(()=>[r(p,{class:"bg-primary text-white"},{default:l(()=>e[2]||(e[2]=[s("div",{class:"text-h6 text-center"},"Prijava Organizatora",-1)])),_:1,__:[2]}),r(p,{class:"q-pa-md"},{default:l(()=>[r(h,{onSubmit:L(g,["prevent"]),ref_key:"loginFormRef",ref:d,class:"q-gutter-sm"},{default:l(()=>[r(m,{outlined:"",modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=t=>i.value=t),label:"Korisni\u010Dko ime","lazy-rules":"",rules:[t=>!!t||"Korisni\u010Dko ime je obavezno"],autocomplete:"username"},null,8,["modelValue","rules"]),r(m,{outlined:"",type:"password",modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=t=>n.value=t),label:"Lozinka","lazy-rules":"",rules:[t=>!!t||"Lozinka je obavezna"],autocomplete:"current-password"},null,8,["modelValue","rules"]),s("div",j,[s("div",{ref_key:"recaptcha",ref:u},null,512)]),s("div",z,[r(k,{label:"Prijava",type:"submit",color:"primary",class:"full-width",size:"lg",disable:!a.value},null,8,["disable"])])]),_:1},512)]),_:1})]),_:1})]),_:1}))}};export{C as default};
